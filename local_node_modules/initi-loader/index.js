import setupDom from "./setup/setupDOM.js";
import initRequirejs from "./setup/requirejs.js";
import initLoader from "./loader/main.js";
import createGlobalLoaderMethods from "./setup/loaderMethods.js";
import { loadGlobalDeps } from "./setup/loadGlobalDeps.js";

const config = {};

export async function init(options) {
    Object.assign(config, options);
    setupDom();
    initRequirejs({ paths: { guiCode: options.paths.guiCode } });
    const { loader, Loader } = initLoader({ 
        loaderConfig: options.loaderOptions,
        loaderPath: options.paths.loader,
    });

    global.loader = globalThis.loader = loader;
    global.Loader = globalThis.Loader = Loader;

    await createGlobalLoaderMethods();
    await loadGlobalDeps();
}

export const version = "1.0.0";
